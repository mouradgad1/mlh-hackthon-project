<!DOCTYPE html>
<html lang="en">


<style>:root {
    --black: #121212;
    --dark-gray: #1e1e1e;
    --medium-gray: #2a2a2a;
    --light-gray: #3a3a3a;
    --white: #ffffff;
    --accent: #1db954;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background-color: var(--black);
    color: var(--white);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
    flex: 1;
}

header {
    text-align: center;
    margin-bottom: 2rem;
    padding: 2rem 0;
    border-bottom: 1px solid var(--medium-gray);
}

header h1 {
    font-size: 3rem;
    margin-bottom: 0.5rem;
    color: var(--white);
}

header p {
    font-size: 1.2rem;
    color: var(--light-gray);
}

.search-container {
    margin-bottom: 2rem;
}

#search-form {
    display: flex;
    max-width: 600px;
    margin: 0 auto;
}

#search-input {
    flex: 1;
    padding: 1rem;
    border: none;
    border-radius: 30px 0 0 30px;
    background-color: var(--dark-gray);
    color: var(--white);
    font-size: 1rem;
    outline: none;
}

#search-form button {
    padding: 1rem 1.5rem;
    background-color: var(--white);
    color: var(--black);
    border: none;
    border-radius: 0 30px 30px 0;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s;
}

#search-form button:hover {
    background-color: var(--accent);
    color: var(--white);
}

.player-container {
    background-color: var(--dark-gray);
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    display: none;
}

.now-playing {
    display: flex;
    align-items: center;
    margin-bottom: 1.5rem;
    gap: 1.5rem;
}

#now-playing-thumbnail {
    width: 80px;
    height: 80px;
    border-radius: 5px;
    object-fit: cover;
}

.track-info h2 {
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 400px;
}

.track-info p {
    color: var(--light-gray);
    font-size: 1rem;
}

.player-controls {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.controls-row {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.progress-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

#progress-bar {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: var(--medium-gray);
    outline: none;
    -webkit-appearance: none;
}

#progress-bar::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background: var(--white);
    cursor: pointer;
}

.time-display {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: var(--light-gray);
}

.volume-control {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

#volume-control {
    width: 80px;
    height: 6px;
    border-radius: 3px;
    background: var(--medium-gray);
    outline: none;
    -webkit-appearance: none;
}

#volume-control::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background: var(--white);
    cursor: pointer;
}

.player-controls button {
    background: none;
    border: none;
    color: var(--white);
    font-size: 1.2rem;
    cursor: pointer;
    transition: color 0.2s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.player-controls button:hover {
    background-color: var(--medium-gray);
}

.results-container h2 {
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
}

.results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
}

.track-card {
    background-color: var(--dark-gray);
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.2s;
    cursor: pointer;
}

.track-card:hover {
    transform: translateY(-5px);
    background-color: var(--medium-gray);
}

.track-thumbnail {
    width: 100%;
    height: 160px;
    object-fit: cover;
}

.track-details {
    padding: 1rem;
}

.track-details h3 {
    font-size: 1rem;
    margin-bottom: 0.5rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.track-details p {
    font-size: 0.9rem;
    color: var(--light-gray);
}

footer {
    text-align: center;
    padding: 1.5rem;
    color: var(--light-gray);
    font-size: 0.9rem;
    border-top: 1px solid var(--medium-gray);
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
    }
    
    header h1 {
        font-size: 2rem;
    }
    
    .results-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    }
    
    .track-info h2 {
        max-width: 200px;
    }
}</style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Music</title>
  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-headphones"></i> NEXUS</h1>
            <p>Stream music in high quality</p>
        </header>

        <div class="search-container">
            <form id="search-form">
                <input type="text" id="search-input" placeholder="Search for songs, artists..." required>
                <button type="submit"><i class="fas fa-search"></i></button>
            </form>
        </div>

        <div class="player-container" id="player-container">
            <div class="now-playing">
                <img id="now-playing-thumbnail" src="" alt="Now Playing">
                <div class="track-info">
                    <h2 id="now-playing-title">No song selected</h2>
                    <p id="now-playing-artist">-</p>
                </div>
            </div>
            <div class="player-controls">
                <audio id="audio-player"></audio>
                <button id="prev-btn"><i class="fas fa-step-backward"></i></button>
                <button id="play-btn"><i class="fas fa-play"></i></button>
                <button id="next-btn"><i class="fas fa-step-forward"></i></button>
                <div class="progress-container">
                    <input type="range" id="progress-bar" value="0">
                    <div class="time-display">
                        <span id="current-time">0:00</span>
                        <span id="duration">0:00</span>
                    </div>
                </div>
                <div class="volume-control">
                    <button id="volume-btn"><i class="fas fa-volume-up"></i></button>
                    <input type="range" id="volume-control" min="0" max="100" value="80">
                </div>
            </div>
        </div>

        <div class="results-container" id="results-container">
            <h2>Search Results</h2>
            <div class="results-grid" id="results-grid">
                <!-- Results will appear here -->
            </div>
        </div>
    </div>

    <footer>
        <p>Â© 2024 Nexus Music | High quality streaming</p>
    </footer>

    <script>document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');
    const resultsGrid = document.getElementById('results-grid');
    const playerContainer = document.getElementById('player-container');
    const nowPlayingThumbnail = document.getElementById('now-playing-thumbnail');
    const nowPlayingTitle = document.getElementById('now-playing-title');
    const nowPlayingArtist = document.getElementById('now-playing-artist');
    const playBtn = document.getElementById('play-btn');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const progressBar = document.getElementById('progress-bar');
    const currentTimeEl = document.getElementById('current-time');
    const durationEl = document.getElementById('duration');
    const volumeBtn = document.getElementById('volume-btn');
    const volumeControl = document.getElementById('volume-control');
    const audioPlayer = document.getElementById('audio-player');

    let currentTrackIndex = 0;
    let searchResults = [];
    let isPlaying = false;

    // Format time (seconds to MM:SS)
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // Search for music
    searchForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const query = searchInput.value.trim();
        if (query) {
            searchMusic(query);
        }
    });

    function searchMusic(query) {
        fetch('/search', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `query=${encodeURIComponent(query)}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error);
                return;
            }
            searchResults = data.results || [];
            displayResults(searchResults);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while searching');
        });
    }

    // Display search results
    function displayResults(results) {
        resultsGrid.innerHTML = '';
        
        if (results.length === 0) {
            resultsGrid.innerHTML = '<p class="no-results">No results found. Try a different search.</p>';
            return;
        }

        results.forEach((track, index) => {
            const trackCard = document.createElement('div');
            trackCard.className = 'track-card';
            trackCard.innerHTML = `
                <img src="${track.thumbnail}" alt="${track.title}" class="track-thumbnail">
                <div class="track-details">
                    <h3>${track.title}</h3>
                    <p>${track.channel || 'Unknown Artist'}</p>
                </div>
            `;
            trackCard.addEventListener('click', () => playTrack(index));
            resultsGrid.appendChild(trackCard);
        });
    }

    // Play selected track
    function playTrack(index) {
        if (index < 0 || index >= searchResults.length) return;
        
        currentTrackIndex = index;
        const track = searchResults[index];
        
        // Update UI
        nowPlayingThumbnail.src = track.thumbnail;
        nowPlayingTitle.textContent = track.title;
        nowPlayingArtist.textContent = track.channel || 'Unknown Artist';
        playerContainer.style.display = 'block';
        
        // Get stream URL
        fetch(`/stream/${track.video_id}`)
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                    return;
                }
                
                // Set audio source and play
                audioPlayer.src = data.audio_url;
                audioPlayer.play()
                    .then(() => {
                        isPlaying = true;
                        playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    })
                    .catch(error => {
                        console.error('Playback failed:', error);
                        alert('Error playing audio');
                    });
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error loading audio');
            });
    }

    // Player controls
    playBtn.addEventListener('click', function() {
        if (audioPlayer.src) {
            if (isPlaying) {
                audioPlayer.pause();
                isPlaying = false;
                playBtn.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                audioPlayer.play()
                    .then(() => {
                        isPlaying = true;
                        playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    });
            }
        }
    });

    nextBtn.addEventListener('click', function() {
        const nextIndex = (currentTrackIndex + 1) % searchResults.length;
        playTrack(nextIndex);
    });

    prevBtn.addEventListener('click', function() {
        const prevIndex = (currentTrackIndex - 1 + searchResults.length) % searchResults.length;
        playTrack(prevIndex);
    });

    // Progress bar update
    audioPlayer.addEventListener('timeupdate', function() {
        if (audioPlayer.duration) {
            progressBar.value = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
            durationEl.textContent = formatTime(audioPlayer.duration);
        }
    });

    // Seek functionality
    progressBar.addEventListener('input', function() {
        const seekTime = (progressBar.value / 100) * audioPlayer.duration;
        audioPlayer.currentTime = seekTime;
    });

    // Volume control
    volumeControl.addEventListener('input', function() {
        audioPlayer.volume = volumeControl.value / 100;
        
        if (volumeControl.value == 0) {
            volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
        } else if (volumeControl.value < 50) {
            volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
        } else {
            volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
        }
    });

    // Toggle mute
    volumeBtn.addEventListener('click', function() {
        if (audioPlayer.volume > 0) {
            audioPlayer.volume = 0;
            volumeControl.value = 0;
            volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
        } else {
            audioPlayer.volume = 0.8;
            volumeControl.value = 80;
            volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
        }
    });

    // When track ends, play next
    audioPlayer.addEventListener('ended', function() {
        const nextIndex = (currentTrackIndex + 1) % searchResults.length;
        playTrack(nextIndex);
    });
});</script>
</body>
</html>